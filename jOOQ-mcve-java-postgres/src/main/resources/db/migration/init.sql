DROP SCHEMA IF EXISTS mcve CASCADE;

CREATE SCHEMA mcve;

CREATE TABLE mcve.parent (
  parent_id bigint not null generated always as identity
);

CREATE UNIQUE INDEX parent_ux ON mcve.parent (parent_id)
;

ALTER TABLE mcve.parent ADD CONSTRAINT parent_pk PRIMARY KEY (parent_id)
;

CREATE TABLE mcve.child (
  child_id bigint not null generated always as identity,
  parent_id bigint not null
);

ALTER TABLE mcve.child
  ADD CONSTRAINT child_parent_fk
    FOREIGN KEY (parent_id)
    REFERENCES mcve.parent (parent_id)
    ON UPDATE CASCADE DEFERRABLE
;