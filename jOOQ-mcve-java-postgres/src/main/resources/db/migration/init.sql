DROP SCHEMA IF EXISTS mcve CASCADE;

CREATE SCHEMA mcve;

CREATE TABLE mcve.parent (
  parent_id bigint not null generated always as identity primary key
);

-- Add three parents
insert into mcve.parent (parent_id) values (DEFAULT), (DEFAULT), (DEFAULT);

CREATE TABLE mcve.child (
  child_id bigint not null generated always as identity primary key,
  parent_id bigint not null references mcve.parent(parent_id)
);

-- Add 10 children for each parent
insert into mcve.child (parent_id)
select parent_id
from mcve.parent
join generate_series(1, 10) on true;

CREATE TABLE mcve.nanny (
  nanny_id bigint not null generated always as identity primary key,
  child_id bigint not null references mcve.child(child_id)
);

-- Give 10 random children a nanny
insert into mcve.nanny (child_id)
select child_id
from mcve.child
order by random() limit 10;